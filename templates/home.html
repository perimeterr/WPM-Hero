<!DOCTYPE html>
<html>
<head>
    <title>WPM Hero</title>
    <style>
        .text-display {
            font-size: 24px;
            margin-bottom: 20px;
        }
        #typing-box {
            width: 100%;
            height: 120px;
            font-size: 20px;
            padding: 10px;
        }
    </style>
</head>
<body>
    <h2>Test Text Display</h2>
    <div class="settings-panel">
        <form method="GET">
            <label>Difficulty:</label>
            <select name="difficulty" onchange="this.form.submit()">
                <option value="easy" {% if test_text.difficulty == "easy" %}selected{% endif %}>Easy</option>
                <option value="medium" {% if test_text.difficulty == "medium" %}selected{% endif %}>Medium</option>
                <option value="hard" {% if test_text.difficulty == "hard" %}selected{% endif %}>Hard</option>
            </select>
        </form>
    </div>

    <div id="text-container" class="text-display">
        {% for char in test_text.display_text %}
            {{ char }}
        {% endfor %}
    </div>

    <hr>
    <h3>Start Typing Below:</h3>
    <textarea id="typing-box" placeholder="Start typing here..."></textarea>

    <p>Time Remaining: <span id="time">60</span> seconds</p>

    <button id="reset-btn">Reset</button>

    <script>
        const typingBox = document.getElementById("typing-box");
        const timeDisplay = document.getElementById("time");
        const resetBtn = document.getElementById("reset-btn");

        let timeLeft = 60;
        let timerStarted = false;
        let countdown = null;

        function startTimer() {
            countdown = setInterval(function () {
                timeLeft--;
                timeDisplay.textContent = timeLeft;

                if (timeLeft <= 0) {
                    clearInterval(countdown);
                    typingBox.disabled = true;
                }

            }, 1000);
        }

        typingBox.addEventListener("input", function () {
            if (!timerStarted && typingBox.value.length > 0) {
                timerStarted = true;
                startTimer();
            }
        });

        resetBtn.addEventListener("click", function () {
            clearInterval(countdown);
            timeLeft = 60;
            timerStarted = false;
            typingBox.disabled = false;
            typingBox.value = "";
            timeDisplay.textContent = timeLeft;
        });
    </script>

</body>
</html>